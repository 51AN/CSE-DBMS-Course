--1--

SELECT DISTINCT ACT_FIRSTNAME, ACT_LASTNAME
FROM ACTOR, DIRECTOR
WHERE ACTOR.ACT_FIRSTNAME = DIRECTOR.DIR_FIRSTNAME AND ACTOR.ACT_LASTNAME = DIRECTOR.DIR_LASTNAME;


--WITH INTERSECTION--
SELECT ACT_FIRSTNAME, ACT_LASTNAME
FROM ACTOR
INTERSECT
SELECT DIR_FIRSTNAME, DIR_LASTNAME
FROM DIRECTOR;


--2--

SELECT ACT_FIRSTNAME
FROM ACTOR
UNION ALL
SELECT DIR_FIRSTNAME
FROM DIRECTOR;

--3--
--PROCESS 1--
SELECT DISTINCT MOV_TITLE
FROM MOVIE, RATING
WHERE MOVIE.MOV_ID = RATING.MOV_ID AND REV_STARS IS NULL;
--PROCESS 2--
SELECT DISTINCT MOV_TITLE
FROM MOVIE JOIN RATING ON RATING.MOV_ID = MOVIE.MOV_ID AND REV_STARS IS NULL
GROUP BY MOV_TITLE;

--WITH MINUS--
SELECT DISTINCT MOV_TITLE
FROM MOVIE, RATING
WHERE MOVIE.MOV_ID = RATING.MOV_ID
MINUS
SELECT DISTINCT MOV_TITLE
FROM MOVIE NATURAL JOIN RATING;


--4--

SELECT AVG(AVG_STARS) AS AVG_RATING
FROM (
    SELECT MOVIE.MOV_TITLE, AVG(REV_STARS) AS AVG_STARS 
    FROM RATING JOIN MOVIE ON RATING.MOV_ID = MOVIE.MOV_ID
    GROUP BY MOVIE.MOV_TITLE) AS A
GROUP BY AVG_STARS;


--5--

SELECT MOVIE.MOV_TITLE, MIN(REV_STARS) AS MIN_STARS 
FROM RATING JOIN MOVIE ON RATING.MOV_ID = MOVIE.MOV_ID
GROUP BY MOVIE.MOV_TITLE
ORDER BY MIN_STARS DESC;

--6--

SELECT ACTOR.ACT_LASTNAME, COUNT(REV_STARS) AS CNT_STARS
FROM CASTS JOIN ACTOR ON CASTS.ACT_ID = ACTOR.ACT_ID JOIN RATING ON CASTS.MOV_ID = RATING.MOV_ID
GROUP BY ACTOR.ACT_LASTNAME;


--7--

SELECT ACTOR.ACT_LASTNAME, MOVIE.MOV_TIME


--8--



--9--

SELECT MOV_TITLE
FROM ACTOR JOIN DIRECTOR ON
    ACTOR.ACT_FIRSTNAME = DIRECTOR.DIR_FIRSTNAME AND ACTOR.ACT_LASTNAME = DIRECTOR.DIR_LASTNAME
    JOIN DIRECTION ON DIRECTOR.DIR_ID = DIRECTION.DIR_ID
    JOIN MOVIE ON DIRECTION.MOV_ID = MOVIE.MOV_ID
GROUP BY MOV_TITLE;

SELECT MOV_ID, MOV_TITLE, MOV_YEAR, MOV_LANGUAGE,MOV_RELEASEDATE,MOV_COUNTRY,MOV_TIME
FROM ACTOR, DIRECTOR, DIRECTION, MOVIE
WHERE  ACTOR.ACT_FIRSTNAME = DIRECTOR.DIR_FIRSTNAME AND ACTOR.ACT_LASTNAME = DIRECTOR.DIR_LASTNAME AND
        DIRECTOR.DIR_ID = DIRECTION.DIR_ID AND
        DIRECTION.MOV_ID = MOVIE.MOV_ID
--10--

SELECT MOVIE.MOV_TITLE, AVG(REV_STARS) AS AVG_STARS 
FROM RATING JOIN MOVIE ON RATING.MOV_ID = MOVIE.MOV_ID
GROUP BY MOVIE.MOV_TITLE
HAVING AVG(REV_STARS) > 7;

--11--




--12--



--13--

SELECT ACT_FIRSTNAME ,COUNT(*) AS Occurrence 
FROM ACTOR 
WHERE ACT_GENDER = 'F'
GROUP BY ACT_FIRSTNAME HAVING COUNT(*)>1; 

--14--
