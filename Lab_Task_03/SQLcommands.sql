conn SYSTEM/12345678

GRANT ALL PRIVILEGES TO s200042151;

conn s200042151/cse4308

CREATE TABLE ACCOUNT
(
    ACCOUNT_NO CHAR (5),
    BALANCE NUMBER NOT NULL,
    CONSTRAINT PK_ACCOUNT_NO PRIMARY KEY (ACCOUNT_NO)
);

CREATE TABLE CUSTOMER
(
    CUSTOMER_NO CHAR (5),
    CUSTOMER_NAME VARCHAR2 (20) NOT NULL,
    CUSTOMER_CITY VARCHAR2 (10),
    CONSTRAINT PK_CUSTOMER_NO  PRIMARY KEY (CUSTOMER_NO)
);

CREATE TABLE DEPOSITOR
(
    ACCOUNT_NO CHAR (5),
    CUSTOMER_NO CHAR (5),
    CONSTRAINT PK_ACCOUNT_NO_CUSTOMER_NO PRIMARY KEY (ACCOUNT_NO, CUSTOMER_NO)
);

--A
ALTER TABLE CUSTOMER ADD DATE_OF_BIRTH DATE;
--B
ALTER TABLE ACCOUNT MODIFY BALANCE NUMBER(12,2);
--C
ALTER TABLE DEPOSITOR RENAME COLUMN ACCOUNT_NO TO A_NO;
ALTER TABLE DEPOSITOR RENAME COLUMN CUSTOMER_NO TO C_NO;
--D
ALTER TABLE DEPOSITOR RENAME TO DEPOSITOR_INFO;
--E
ALTER TABLE DEPOSITOR_INFO ADD CONSTRAINT FK_DEPOSITOR_ACCOUNT FOREIGN KEY (A_NO)
REFERENCES ACCOUNT(ACCOUNT_NO);
ALTER TABLE DEPOSITOR_INFO ADD CONSTRAINT FK_DEPOSITOR_CUSTOMER FOREIGN KEY (C_NO)
REFERENCES CUSTOMER(CUSTOMER_NO);


INSERT INTO ACCOUNT VALUES ('A-101', 69420);
INSERT INTO ACCOUNT VALUES ('A-102', 19900);
INSERT INTO ACCOUNT VALUES ('A-103', 9990);
INSERT INTO ACCOUNT VALUES ('A-104', 123445678);
INSERT INTO ACCOUNT VALUES ('A-105', 1);
INSERT INTO ACCOUNT VALUES ('A-106', 42069);
INSERT INTO ACCOUNT VALUES ('A-107', 404404);

INSERT INTO CUSTOMER VALUES ('C-101', 'SIAN', 'DHK', '31-JUL-01');
INSERT INTO CUSTOMER VALUES ('C-102', 'DIHAN', 'KHL', '07-AUG-01');
INSERT INTO CUSTOMER VALUES ('C-103', 'AKASH', 'DHK', '29-APR-01');
INSERT INTO CUSTOMER VALUES ('C-104', 'ANAN', 'KHL', '19-JUL-01');
INSERT INTO CUSTOMER VALUES ('C-105', 'NOWRID', 'KHL', '1-APR-00');
INSERT INTO CUSTOMER VALUES ('C-106', 'ONGKON', 'DHK', '31-JUL-01');

INSERT INTO DEPOSITOR_INFO VALUES ('A-101', 'C-101');
INSERT INTO DEPOSITOR_INFO VALUES ('A-102', 'C-102');
INSERT INTO DEPOSITOR_INFO VALUES ('A-103', 'C-103');
INSERT INTO DEPOSITOR_INFO VALUES ('A-104', 'C-104');
INSERT INTO DEPOSITOR_INFO VALUES ('A-105', 'C-105');
INSERT INTO DEPOSITOR_INFO VALUES ('A-106', 'C-106');

SET PAGESIZE 100;

--A
SELECT ACCOUNT_NO FROM ACCOUNT WHERE BALANCE > 100000;
--B
SELECT CUSTOMER_NAME FROM CUSTOMER WHERE CUSTOMER_CITY = 'DHK';
--C
SELECT CUSTOMER_NO FROM CUSTOMER WHERE CUSTOMER_NAME LIKE '%A%';
--D
SELECT DISTINCT A_NO FROM DEPOSITOR_INFO ORDER BY A_NO ASC;
--E
SELECT * FROM ACCOUNT, DEPOSITOR_INFO;
--F
SELECT * FROM CUSTOMER NATURAL JOIN DEPOSITOR_INFO;
--G
SELECT CUSTOMER_NAME, CUSTOMER_CITY 
FROM DEPOSITOR_INFO,CUSTOMER,ACCOUNT 
WHERE DEPOSITOR_INFO.C_NO = CUSTOMER.CUSTOMER_NO AND DEPOSITOR_INFO.A_NO = ACCOUNT.ACCOUNT_NO;
--H
SELECT CUSTOMER_NO,CUSTOMER_NAME, CUSTOMER_CITY 
FROM CUSTOMER,ACCOUNT,DEPOSITOR_INFO 
WHERE DEPOSITOR_INFO.A_NO = ACCOUNT.ACCOUNT_NO AND DEPOSITOR_INFO.C_NO = CUSTOMER.CUSTOMER_NO AND ACCOUNT.BALANCE > 1000;
--I
SELECT DISTINCT ACCOUNT_NO,BALANCE 
FROM CUSTOMER,ACCOUNT,DEPOSITOR_INFO 
WHERE DEPOSITOR_INFO.A_NO = ACCOUNT.ACCOUNT_NO AND DEPOSITOR_INFO.C_NO = CUSTOMER.CUSTOMER_NO AND CUSTOMER.CUSTOMER_CITY = 'DHK' 
OR ACCOUNT.BALANCE BETWEEN 5000 AND 10000;

